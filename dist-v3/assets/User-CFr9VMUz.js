import{d as N,S as P,z as a,G as R,j as U,f as s,b as o,v as c,Z as v,$ as X,X as V,a0 as Z,t as p,a1 as y,a2 as z,o as Q,h as $}from"./index-D_giRRmy.js";import{g as H,f as J,a as K,d as O}from"./user-Bbnl0Tke.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"covering"},ss={class:"card"},es={class:"search-box"},ls={class:"card"},ts={class:"card-header"},as=["onClick"],os=["onClick"],ns=["onClick"],us={class:"pagination-container"},ds={class:"pagination"},rs=["disabled"],is={class:"page-numbers"},vs=["disabled"],ps={class:"add-card",id:"userForm"},cs={class:"card-header"},fs={class:"form-group"},ms={class:"form-group"},bs={class:"form-group"},ws={class:"form-group"},gs={class:"getPwd"},ys=N({__name:"User",setup(ks){const q=z();P(!0);const f=a([]),m=a(0),u=a(1),x=a(0),d=a(5),b=a(!1),k=a(""),n=a({}),w=a(!1),C=a(""),D=a(""),g=a(!1),r=a(!1),B={id:"",username:"",is_superuser:!1,is_staff:!0,QQ:"",email:"",password:""};a(!1);const I=async t=>{q.push({path:"/userdetail",query:{pk:t.id}})},L=t=>{q.push({path:"/event",query:{pk:t.id}})},S=()=>{b.value=!1,r.value=!1},F=()=>{g.value=!1,r.value=!1},i=async(t=1,e=5)=>{const l=await H({page:t,page_size:e});l.status===200&&y.success("获取用户信息列表成功"),m.value=l.data.count,x.value=m.value%e==0?Math.floor(m.value/e):Math.floor(m.value/e)+1,f.value=l.data.results},E=async()=>{const t=await J(k.value);t.status===200&&y.success("查找用户成功"),f.value=[],f.value.push(t.data)},T=()=>{b.value=!0,r.value=!0,n.value={QQ:"",email:"",password:"",username:""},w.value=!1},j=async()=>{const{username:t,email:e,password:l,QQ:_}=n.value,M=await K({username:t,email:e,password:l,qq:_});M.status>=200&&M.status<300&&y.success("用户添加成功"),b.value=!1,r.value=!1,i(u.value,d.value)},A=async()=>{const t=await O(D.value,C.value);t.status>=200&&t.status<300&&y.success("用户删除成功"),g.value=!1,r.value=!1,i(u.value,d.value)},G=t=>{D.value=t,g.value=!0,r.value=!0};return R(()=>{i(),n.value=B}),(t,e)=>(Q(),U(V,null,[e[19]||(e[19]=s("div",{class:"header"},[s("h2",null,"用户管理")],-1)),o(s("div",Y,null,512),[[c,r.value]]),s("div",ss,[s("div",es,[o(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>k.value=l),type:"text",placeholder:"搜索用户ID/用户名/邮箱..."},null,512),[[v,k.value]]),s("button",{onClick:E},"搜索")]),s("button",{onClick:T,class:"btn btn-primary"},"添加用户")]),s("div",ls,[s("div",ts,[e[12]||(e[12]=s("h3",null,"用户列表",-1)),s("div",null,[o(s("select",{onChange:e[1]||(e[1]=l=>i(u.value,d.value)),"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l),class:"select",style:{width:"auto",display:"inline-block"}},e[11]||(e[11]=[s("option",{value:"5"},"每页5条",-1),s("option",{value:"10"},"每页10条",-1),s("option",{value:"20"},"每页20条",-1)]),544),[[X,d.value]])])]),s("table",null,[e[13]||(e[13]=s("thead",null,[s("tr",null,[s("th",null,"序号"),s("th",null,"用户名"),s("th",null,"身份"),s("th",null,"邮箱"),s("th",null,"操作")])],-1)),s("tbody",null,[(Q(!0),U(V,null,Z(f.value,(l,_)=>(Q(),U("tr",{onClick:h=>I(l)},[s("td",null,p(d.value*(u.value-1)+_+1),1),s("td",null,p(l.username),1),s("td",null,p(l.is_superuser?"管理员":"普通用户"),1),s("td",null,p(l.email),1),s("td",null,[s("button",{class:"btn btn-primary",onClick:$(h=>L(l),["stop"])},"事件",8,os),s("button",{onClick:$(h=>G(l.id),["stop"]),class:"btn btn-danger"},"删除",8,ns)])],8,as))),256))])]),s("div",us,[s("div",ds,[s("button",{onClick:e[3]||(e[3]=l=>i(--u.value,d.value)),class:"page-btn prev-btn",disabled:u.value==1},"上一页",8,rs),s("div",is,p(u.value),1),s("button",{onClick:e[4]||(e[4]=l=>i(++u.value,d.value)),class:"page-btn next-btn",disabled:u.value>=x.value},"下一页",8,vs)])])]),o(s("div",ps,[s("div",cs,[s("h3",null,p(w.value?"编辑用户":"添加用户"),1),s("button",{onClick:S,class:"cancle"},"×")]),s("form",null,[s("div",fs,[e[14]||(e[14]=s("label",{for:"username"},"用户名",-1)),o(s("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.username=l),type:"text",class:"form-control",required:""},null,512),[[v,n.value.username]])]),s("div",ms,[e[15]||(e[15]=s("label",{for:"qq"},"QQ",-1)),o(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>n.value.QQ=l),type:"text",class:"form-control",required:""},null,512),[[v,n.value.QQ]])]),s("div",bs,[e[16]||(e[16]=s("label",{for:"email"},"邮箱",-1)),o(s("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>n.value.email=l),type:"email",class:"form-control",required:""},null,512),[[v,n.value.email]])]),o(s("div",ws,[e[17]||(e[17]=s("label",{for:"password"},"密码",-1)),o(s("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>n.value.password=l),type:"password",class:"form-control",required:""},null,512),[[v,n.value.password]])],512),[[c,!w.value]]),o(s("div",{onClick:j,type:"submit",class:"btn btn-success"},"添加",512),[[c,!w.value]])])],512),[[c,b.value]]),o(s("div",gs,[e[18]||(e[18]=s("h2",null,"请输入密码",-1)),o(s("input",{class:"pwd-inp",type:"password","onUpdate:modelValue":e[9]||(e[9]=l=>C.value=l)},null,512),[[v,C.value]]),s("button",{class:"Del-btn",onClick:e[10]||(e[10]=l=>A())},"删除"),s("button",{class:"cancelDel",onClick:F},"取消")],512),[[c,g.value]])],64))}}),Us=W(ys,[["__scopeId","data-v-32c65814"]]);export{Us as default};
