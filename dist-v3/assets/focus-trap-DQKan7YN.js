import{bG as X,aa as fe,ab as ye,bs as Y,ad as ve,bH as pe,bu as Se,a8 as _e,bv as Ie,bI as Pe,as as we,bA as Ce,bB as Ae,aj as S,ak as H,U as m,z as b,y as L,G as O,F as _,b4 as Le,aO as Oe,bJ as Ne,a$ as Re,aU as k,J as j,n as $,H as V,Q,L as Z,E as Ee,_ as xe,d as Ue,p as ke,b3 as Ke,K as De,au as $e}from"./index-D_giRRmy.js";function He(e){return e}function Ve(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var ze=800,Be=16,Me=Date.now;function Ge(e){var t=0,n=0;return function(){var s=Me(),o=Be-(s-n);if(n=s,o>0){if(++t>=ze)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function qe(e){return function(){return e}}var Je=X?function(e,t){return X(e,"toString",{configurable:!0,enumerable:!1,value:qe(t),writable:!0})}:He,We=Ge(Je),ee=Math.max;function Xe(e,t,n){return t=ee(t===void 0?e.length-1:t,0),function(){for(var s=arguments,o=-1,u=ee(s.length-t,0),i=Array(u);++o<u;)i[o]=s[t+o];o=-1;for(var a=Array(t+1);++o<t;)a[o]=s[o];return a[t]=n(i),Ve(e,this,a)}}var Ye=9007199254740991;function je(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ye}var Qe="[object Arguments]";function te(e){return fe(e)&&ye(e)==Qe}var me=Object.prototype,Ze=me.hasOwnProperty,et=me.propertyIsEnumerable,be=te(function(){return arguments}())?te:function(e){return fe(e)&&Ze.call(e,"callee")&&!et.call(e,"callee")};function tt(e,t){for(var n=-1,s=t.length,o=e.length;++n<s;)e[o+n]=t[n];return e}var ne=Y?Y.isConcatSpreadable:void 0;function nt(e){return ve(e)||be(e)||!!(ne&&e&&e[ne])}function st(e,t,n,s,o){var u=-1,i=e.length;for(n||(n=nt),o||(o=[]);++u<i;){var a=e[u];n(a)?tt(o,a):o[o.length]=a}return o}function ot(e){var t=e==null?0:e.length;return t?st(e):[]}function rt(e){return We(Xe(e,void 0,ot),e+"")}function at(e,t){return e!=null&&t in Object(e)}function ut(e,t,n){t=pe(t,e);for(var s=-1,o=t.length,u=!1;++s<o;){var i=Se(t[s]);if(!(u=e!=null&&n(e,i)))break;e=e[i]}return u||++s!=o?u:(o=e==null?0:e.length,!!o&&je(o)&&_e(i,o)&&(ve(e)||be(e)))}function it(e,t){return e!=null&&ut(e,t,at)}function ct(e,t,n){for(var s=-1,o=t.length,u={};++s<o;){var i=t[s],a=Ie(e,i);n(a,i)&&Pe(u,pe(i,e),a)}return u}function lt(e,t){return ct(e,t,function(n,s){return it(e,s)})}var dt=rt(function(e,t){return e==null?{}:lt(e,t)});class ft extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function Ut(e,t){throw new ft(`[${e}] ${t}`)}function kt(e,t){}const Kt="update:modelValue",Dt="change",$t="input",vt=we({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),Ht=e=>dt(vt,e),se={prefix:Math.floor(Math.random()*1e4),current:0},pt=Symbol("elIdInjection"),Et=()=>H()?S(pt,se):se,mt=e=>{const t=Et(),n=Ce();return Ae(()=>m(e)||`${n.value}-id-${t.prefix}-${t.current++}`)},z=Symbol("formContextKey"),he=Symbol("formItemContextKey"),Vt=()=>{const e=S(z,void 0),t=S(he,void 0);return{form:e,formItem:t}},zt=(e,{formItemContext:t,disableIdGeneration:n,disableIdManagement:s})=>{n||(n=b(!1)),s||(s=b(!1));const o=b();let u;const i=L(()=>{var a;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((a=t.inputIds)==null?void 0:a.length)<=1)});return O(()=>{u=_([Le(e,"id"),n],([a,l])=>{const f=a??(l?void 0:mt().value);f!==o.value&&(t?.removeInputId&&(o.value&&t.removeInputId(o.value),!s?.value&&!l&&f&&t.addInputId(f)),o.value=f)},{immediate:!0})}),Oe(()=>{u&&u(),t?.removeInputId&&o.value&&t.removeInputId(o.value)}),{isLabeledByFormItem:i,inputId:o}},Te=e=>{const t=H();return L(()=>{var n,s;return(s=(n=t?.proxy)==null?void 0:n.$props)==null?void 0:s[e]})},Bt=(e,t={})=>{const n=b(void 0),s=t.prop?n:Te("size"),o=t.global?n:Ne(),u=t.form?{size:void 0}:S(z,void 0),i=t.formItem?{size:void 0}:S(he,void 0);return L(()=>s.value||m(e)||i?.size||u?.size||o.value||"")},Mt=e=>{const t=Te("disabled"),n=S(z,void 0);return L(()=>t.value||m(e)||n?.disabled||!1)},bt='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',ht=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,Gt=e=>Array.from(e.querySelectorAll(bt)).filter(t=>B(t)&&ht(t)),B=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}};function qt(e,{disabled:t,beforeFocus:n,afterFocus:s,beforeBlur:o,afterBlur:u}={}){const i=H(),{emit:a}=i,l=Re(),f=b(!1),h=d=>{const r=j(n)?n(d):!1;m(t)||f.value||r||(f.value=!0,a("focus",d),s?.())},F=d=>{var r;const c=j(o)?o(d):!1;m(t)||d.relatedTarget&&((r=l.value)!=null&&r.contains(d.relatedTarget))||c||(f.value=!1,a("blur",d),u?.())},I=d=>{var r,c;m(t)||B(d.target)||(r=l.value)!=null&&r.contains(document.activeElement)&&l.value!==document.activeElement||(c=e.value)==null||c.focus()};return _([l,()=>m(t)],([d,r])=>{d&&(r?d.removeAttribute("tabindex"):d.setAttribute("tabindex","-1"))}),k(l,"focus",h,!0),k(l,"blur",F,!0),k(l,"click",I,!0),{isFocused:f,wrapperRef:l,handleFocus:h,handleBlur:F}}const Tt=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e);function Jt({afterComposition:e,emit:t}){const n=b(!1),s=a=>{t?.("compositionstart",a),n.value=!0},o=a=>{var l;t?.("compositionupdate",a);const f=(l=a.target)==null?void 0:l.value,h=f[f.length-1]||"";n.value=!Tt(h)},u=a=>{t?.("compositionend",a),n.value&&(n.value=!1,$(()=>e(a)))};return{isComposing:n,handleComposition:a=>{a.type==="compositionend"?u(a):o(a)},handleCompositionStart:s,handleCompositionUpdate:o,handleCompositionEnd:u}}const K="focus-trap.focus-after-trapped",D="focus-trap.focus-after-released",gt="focus-trap.focusout-prevented",oe={cancelable:!0,bubbles:!1},Ft={cancelable:!0,bubbles:!1},re="focusAfterTrapped",ae="focusAfterReleased",yt=Symbol("elFocusTrap"),M=b(),N=b(0),G=b(0);let w=0;const ge=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const o=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||o?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},ue=(e,t)=>{for(const n of e)if(!St(n,t))return n},St=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},_t=e=>{const t=ge(e),n=ue(t,e),s=ue(t.reverse(),e);return[n,s]},It=e=>e instanceof HTMLInputElement&&"select"in e,g=(e,t)=>{if(e&&e.focus){const n=document.activeElement;let s=!1;Q(e)&&!B(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),s=!0),e.focus({preventScroll:!0}),G.value=window.performance.now(),e!==n&&It(e)&&t&&e.select(),Q(e)&&s&&e.removeAttribute("tabindex")}};function ie(e,t){const n=[...e],s=e.indexOf(t);return s!==-1&&n.splice(s,1),n}const Pt=()=>{let e=[];return{push:s=>{const o=e[0];o&&s!==o&&o.pause(),e=ie(e,s),e.unshift(s)},remove:s=>{var o,u;e=ie(e,s),(u=(o=e[0])==null?void 0:o.resume)==null||u.call(o)}}},wt=(e,t=!1)=>{const n=document.activeElement;for(const s of e)if(g(s,t),document.activeElement!==n)return},ce=Pt(),Ct=()=>N.value>G.value,C=()=>{M.value="pointer",N.value=window.performance.now()},le=()=>{M.value="keyboard",N.value=window.performance.now()},At=()=>(O(()=>{w===0&&(document.addEventListener("mousedown",C),document.addEventListener("touchstart",C),document.addEventListener("keydown",le)),w++}),V(()=>{w--,w<=0&&(document.removeEventListener("mousedown",C),document.removeEventListener("touchstart",C),document.removeEventListener("keydown",le))}),{focusReason:M,lastUserFocusTimestamp:N,lastAutomatedFocusTimestamp:G}),A=e=>new CustomEvent(gt,{...Ft,detail:e});let y=[];const de=e=>{e.code===Ee.esc&&y.forEach(t=>t(e))},Lt=e=>{O(()=>{y.length===0&&document.addEventListener("keydown",de),Z&&y.push(e)}),V(()=>{y=y.filter(t=>t!==e),y.length===0&&Z&&document.removeEventListener("keydown",de)})},Ot=Ue({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[re,ae,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const n=b();let s,o;const{focusReason:u}=At();Lt(r=>{e.trapped&&!i.paused&&t("release-requested",r)});const i={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=r=>{if(!e.loop&&!e.trapped||i.paused)return;const{code:c,altKey:v,ctrlKey:p,metaKey:E,currentTarget:q,shiftKey:J}=r,{loop:W}=e,Fe=c===Ee.tab&&!v&&!p&&!E,P=document.activeElement;if(Fe&&P){const R=q,[x,U]=_t(R);if(x&&U){if(!J&&P===U){const T=A({focusReason:u.value});t("focusout-prevented",T),T.defaultPrevented||(r.preventDefault(),W&&g(x,!0))}else if(J&&[x,R].includes(P)){const T=A({focusReason:u.value});t("focusout-prevented",T),T.defaultPrevented||(r.preventDefault(),W&&g(U,!0))}}else if(P===R){const T=A({focusReason:u.value});t("focusout-prevented",T),T.defaultPrevented||r.preventDefault()}}};$e(yt,{focusTrapRef:n,onKeydown:a}),_(()=>e.focusTrapEl,r=>{r&&(n.value=r)},{immediate:!0}),_([n],([r],[c])=>{r&&(r.addEventListener("keydown",a),r.addEventListener("focusin",h),r.addEventListener("focusout",F)),c&&(c.removeEventListener("keydown",a),c.removeEventListener("focusin",h),c.removeEventListener("focusout",F))});const l=r=>{t(re,r)},f=r=>t(ae,r),h=r=>{const c=m(n);if(!c)return;const v=r.target,p=r.relatedTarget,E=v&&c.contains(v);e.trapped||p&&c.contains(p)||(s=p),E&&t("focusin",r),!i.paused&&e.trapped&&(E?o=v:g(o,!0))},F=r=>{const c=m(n);if(!(i.paused||!c))if(e.trapped){const v=r.relatedTarget;!Ke(v)&&!c.contains(v)&&setTimeout(()=>{if(!i.paused&&e.trapped){const p=A({focusReason:u.value});t("focusout-prevented",p),p.defaultPrevented||g(o,!0)}},0)}else{const v=r.target;v&&c.contains(v)||t("focusout",r)}};async function I(){await $();const r=m(n);if(r){ce.push(i);const c=r.contains(document.activeElement)?s:document.activeElement;if(s=c,!r.contains(c)){const p=new Event(K,oe);r.addEventListener(K,l),r.dispatchEvent(p),p.defaultPrevented||$(()=>{let E=e.focusStartEl;De(E)||(g(E),document.activeElement!==E&&(E="first")),E==="first"&&wt(ge(r),!0),(document.activeElement===c||E==="container")&&g(r)})}}}function d(){const r=m(n);if(r){r.removeEventListener(K,l);const c=new CustomEvent(D,{...oe,detail:{focusReason:u.value}});r.addEventListener(D,f),r.dispatchEvent(c),!c.defaultPrevented&&(u.value=="keyboard"||!Ct()||r.contains(document.activeElement))&&g(s??document.body),r.removeEventListener(D,f),ce.remove(i)}}return O(()=>{e.trapped&&I(),_(()=>e.trapped,r=>{r?I():d()})}),V(()=>{e.trapped&&d(),n.value&&(n.value.removeEventListener("keydown",a),n.value.removeEventListener("focusin",h),n.value.removeEventListener("focusout",F),n.value=void 0)}),{onKeydown:a}}});function Nt(e,t,n,s,o,u){return ke(e.$slots,"default",{handleKeydown:e.onKeydown})}var Wt=xe(Ot,[["render",Nt],["__file","focus-trap.vue"]]);export{Dt as C,Wt as E,yt as F,$t as I,Kt as U,Xe as a,be as b,st as c,Ht as d,Mt as e,Vt as f,kt as g,Bt as h,He as i,zt as j,qt as k,Jt as l,je as m,tt as n,Gt as o,dt as p,it as q,B as r,We as s,Ut as t,mt as u,he as v,Et as w,g as x};
