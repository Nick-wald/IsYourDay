import{H as re,I as L,z as B,b as de,h as ue,J as D,_ as ce,m as me,o as pe,a as he,K as fe,L as we,d as ge,E as I,M as ve,w as ye,f as V}from"./base-B1x2bpfq.js";import{E as G,a as X,b as Y}from"./el-table-column-DxSn_1Z8.js";import"./el-overlay-BGIb9NVd.js";import"./el-tag-DjpAT_K6.js";import{b as Z,a as $,E as ee}from"./el-select-DrxOIgem.js";import"./el-checkbox-DhdOa0pM.js";import{E as te}from"./el-button-3LcmKSGv.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as z,d as se,i as R,r as O,I as J,x as ke,c as y,o as u,a as m,n as f,Q as Se,u as l,p as _,j as w,w as c,K as U,t as S,q,b as r,E as xe,l as _e,L as Te,W as Q,g as E,F as Ee,B as Ve}from"./index-b-6tx6qQ.js";import{I as j,C as F,U as H,u as Re,t as Ce,d as Ie}from"./vnode-sIyvmkMX.js";import{E as ie}from"./index-DiXiNdn3.js";import"./raf-Bo6rU8aI.js";const Me=t=>["",...re].includes(t),Pe=de({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Me},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:D},activeActionIcon:{type:D},activeIcon:{type:D},inactiveIcon:{type:D},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:ue(Function)},id:String,tabindex:{type:[String,Number]},...Re(["ariaLabel"])}),Ue={[H]:t=>L(t)||z(t)||B(t),[F]:t=>L(t)||z(t)||B(t),[j]:t=>L(t)||z(t)||B(t)},ae="ElSwitch",Ae=se({name:ae}),De=se({...Ae,props:Pe,emits:Ue,setup(t,{expose:e,emit:o}){const i=t,{formItem:s}=me(),p=pe(),d=he("switch"),{inputId:C}=fe(i,{formItemContext:s}),g=we(R(()=>i.loading)),T=O(i.modelValue!==!1),b=O(),v=O(),x=R(()=>[d.b(),d.m(p.value),d.is("disabled",g.value),d.is("checked",h.value)]),M=R(()=>[d.e("label"),d.em("label","left"),d.is("active",!h.value)]),N=R(()=>[d.e("label"),d.em("label","right"),d.is("active",h.value)]),a=R(()=>({width:ge(i.width)}));J(()=>i.modelValue,()=>{T.value=!0});const P=R(()=>T.value?i.modelValue:!1),h=R(()=>P.value===i.activeValue);[i.activeValue,i.inactiveValue].includes(P.value)||(o(H,i.inactiveValue),o(F,i.inactiveValue),o(j,i.inactiveValue)),J(h,n=>{var k;b.value.checked=n,i.validateEvent&&((k=s?.validate)==null||k.call(s,"change").catch(le=>Ie()))});const A=()=>{const n=h.value?i.inactiveValue:i.activeValue;o(H,n),o(F,n),o(j,n),Te(()=>{b.value.checked=h.value})},K=()=>{if(g.value)return;const{beforeChange:n}=i;if(!n){A();return}const k=n();[Q(k),L(k)].includes(!0)||Ce(ae,"beforeChange must return type `Promise<boolean>` or `boolean`"),Q(k)?k.then(W=>{W&&A()}).catch(W=>{}):k&&A()},oe=()=>{var n,k;(k=(n=b.value)==null?void 0:n.focus)==null||k.call(n)};return ke(()=>{b.value.checked=h.value}),e({focus:oe,checked:h}),(n,k)=>(u(),y("div",{class:_(l(x)),onClick:_e(K,["prevent"])},[m("input",{id:l(C),ref_key:"input",ref:b,class:_(l(d).e("input")),type:"checkbox",role:"switch","aria-checked":l(h),"aria-disabled":l(g),"aria-label":n.ariaLabel,name:n.name,"true-value":n.activeValue,"false-value":n.inactiveValue,disabled:l(g),tabindex:n.tabindex,onChange:A,onKeydown:Se(K,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!n.inlinePrompt&&(n.inactiveIcon||n.inactiveText)?(u(),y("span",{key:0,class:_(l(M))},[n.inactiveIcon?(u(),w(l(I),{key:0},{default:c(()=>[(u(),w(U(n.inactiveIcon)))]),_:1})):f("v-if",!0),!n.inactiveIcon&&n.inactiveText?(u(),y("span",{key:1,"aria-hidden":l(h)},S(n.inactiveText),9,["aria-hidden"])):f("v-if",!0)],2)):f("v-if",!0),m("span",{ref_key:"core",ref:v,class:_(l(d).e("core")),style:xe(l(a))},[n.inlinePrompt?(u(),y("div",{key:0,class:_(l(d).e("inner"))},[n.activeIcon||n.inactiveIcon?(u(),w(l(I),{key:0,class:_(l(d).is("icon"))},{default:c(()=>[(u(),w(U(l(h)?n.activeIcon:n.inactiveIcon)))]),_:1},8,["class"])):n.activeText||n.inactiveText?(u(),y("span",{key:1,class:_(l(d).is("text")),"aria-hidden":!l(h)},S(l(h)?n.activeText:n.inactiveText),11,["aria-hidden"])):f("v-if",!0)],2)):f("v-if",!0),m("div",{class:_(l(d).e("action"))},[n.loading?(u(),w(l(I),{key:0,class:_(l(d).is("loading"))},{default:c(()=>[r(l(ve))]),_:1},8,["class"])):l(h)?q(n.$slots,"active-action",{key:1},()=>[n.activeActionIcon?(u(),w(l(I),{key:0},{default:c(()=>[(u(),w(U(n.activeActionIcon)))]),_:1})):f("v-if",!0)]):l(h)?f("v-if",!0):q(n.$slots,"inactive-action",{key:2},()=>[n.inactiveActionIcon?(u(),w(l(I),{key:0},{default:c(()=>[(u(),w(U(n.inactiveActionIcon)))]),_:1})):f("v-if",!0)])],2)],6),!n.inlinePrompt&&(n.activeIcon||n.activeText)?(u(),y("span",{key:1,class:_(l(N))},[n.activeIcon?(u(),w(l(I),{key:0},{default:c(()=>[(u(),w(U(n.activeIcon)))]),_:1})):f("v-if",!0),!n.activeIcon&&n.activeText?(u(),y("span",{key:1,"aria-hidden":!l(h)},S(n.activeText),9,["aria-hidden"])):f("v-if",!0)],2)):f("v-if",!0)],10,["onClick"]))}});var Le=ce(De,[["__file","switch.vue"]]);const ne=ye(Le),Ne={components:{ElTable:Y,ElTableColumn:X,ElButton:te,ElInput:ie,ElSelect:ee,ElOption:$,ElDialog:G,ElSwitch:ne,ElTag:Z},props:{receiveUserOptions:{type:Array,default:()=>[{value:"user1",label:"用户一"},{value:"user2",label:"用户二"},{value:"user3",label:"用户三"},{value:"user4",label:"用户四"},{value:"user5",label:"用户五"},{value:"robot",label:"企微小助手"}]}},data(){return{workflowUrl:"http://117.72.163.39/v1/workflows/run",apiKey:"app-I4UqbfaquFV7y0raCe46596W",robotApiKey:"app-kOUC9LdgOiSAdXViV77xZPNC",username:"abab",key:"28261009",mode:null,selectMode:null,receiveUsername:[],workflowResults:[],isLoading:!1,errorMessage:null,accessToken:null,isSending:!1,isSendingAll:!1,editDialogVisible:!1,editingRow:null,editingIndex:-1,isSaving:!1,manualSendMode:!0,autoSendQueue:[],isAutoSending:!1}},computed:{isFormValid(){const t=this.username.trim()!==""&&this.key.trim()!=="",e=this.mode!==null,o=this.selectMode!==null,i=this.selectMode===1?this.receiveUsername.length>0:!0;return t&&e&&o&&i}},watch:{username(){this.resetToken()},key(){this.resetToken()},"editingRow.text":{handler(t){this.renderEmailPreview(t)},immediate:!0},manualSendMode(t){!t&&this.workflowResults.length>0&&this.autoSendAllPending()}},methods:{stripHtmlTags(t){return t?t.replace(/<[^>]*>?/gm,""):""},openHtmlInNewWindow(t){try{const e=window.open("","_blank","width=1000,height=800,scrollbars=yes");if(!e){this.errorMessage="浏览器阻止了弹出窗口，请允许弹出后重试";return}e.document.write(`
          <!DOCTYPE html>
          <html lang="zh-CN">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>HTML内容预览</title>
            <style>
              body { 
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                padding: 30px;
                max-width: 1200px;
                margin: 0 auto;
                line-height: 1.6;
              }
              .preview-header {
                border-bottom: 2px solid #f0f0f0;
                padding-bottom: 15px;
                margin-bottom: 20px;
              }
              .preview-title {
                color: #333;
                margin: 0;
              }
              .preview-content {
                color: #444;
              }
            </style>
          </head>
          <body>
            <div class="preview-header">
              <h2 class="preview-title">完整HTML内容预览</h2>
            </div>
            <div class="preview-content">
              ${t}
            </div>
          </body>
          </html>
        `),e.document.close()}catch(e){this.errorMessage=`打开预览失败：${e.message}`,console.error("预览窗口错误：",e)}},openEditDialog(t,e){this.editingRow={...t,originalText:t.text,originalTitle:t.title},this.editingIndex=e,this.editDialogVisible=!0,this.$nextTick(()=>{this.renderEmailPreview(t.text)})},renderEmailPreview(t){const e=this.$refs.previewContainer;if(!e||!t)return;e.innerHTML="";const o=document.createElement("div");e.appendChild(o);const i=o.attachShadow({mode:"open"}),s=document.createElement("div");s.innerHTML=t;const p=document.createElement("style");p.textContent=`
        body {
          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
          margin: 0;
          padding: 0;
          color: #333;
        }
        * {
          box-sizing: border-box;
        }
      `,i.appendChild(p),i.appendChild(s)},saveEditedRow(){if(!this.editingRow||this.editingIndex===-1)return;if(!(this.editingRow.text!==this.editingRow.originalText||this.editingRow.title!==this.editingRow.originalTitle)){V.info("内容未发生变化"),this.editDialogVisible=!1;return}this.isSaving=!0,setTimeout(()=>{this.workflowResults[this.editingIndex].text=this.editingRow.text,this.workflowResults[this.editingIndex].title=this.editingRow.title,V.success("修改已保存"),this.isSaving=!1,this.editDialogVisible=!1},800)},resetToken(){this.accessToken=null},async login(){try{const t=await fetch("https://api.nickwald.top/account/auth/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:this.username,password:this.key,from:""})});if(!t.ok)throw new Error(`登录失败: ${t.status}`);const e=await t.json(),o=e.from_url||"",i=e.ticket||"",s=await fetch(`https://api.nickwald.top/account/auth/?ticket=${i}&from=&client_verify=${o}&action=client`);if(!s.ok)throw new Error(`获取用户信息失败: ${s.status}`);return(await s.json()).access}catch(t){return this.errorMessage=`认证失败: ${t.message}`,console.error("登录错误:",t),null}},async getAccessToken(){return this.accessToken?this.accessToken:(this.accessToken=await this.login(),this.accessToken)},async sendRobotMessage(t){try{const e=await fetch(this.workflowUrl,{method:"POST",headers:{Authorization:`Bearer ${this.robotApiKey}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:{robot_id:t.user_id,robot_text:t.text},response_mode:"blocking",user:"external-system"})});if(!e.ok)throw new Error(`机器人请求失败: ${e.status}`);const o=await e.json();return console.log("机器人发送成功:",o),!0}catch(e){throw console.error("发送机器人消息错误:",e),e}},async sendSingleEmail(t){try{if(this.isSending=!0,t.isSending=!0,t.username.includes("企微小助手"))await this.sendRobotMessage(t),V.success(`机器人消息发送成功: ${t.username}`);else{const e=await this.getAccessToken();if(!e)throw new Error("无法获取访问令牌，请检查用户名和密码");const o=new URLSearchParams;o.append("type","email"),o.append("pk",t.user_id),o.append("content",t.text),o.append("subject",t.title);const i=await fetch("https://api.nickwald.top/isyourday/",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!i.ok){const p=await i.text();throw new Error(`请求失败 (${i.status}): ${p}`)}const s=await i.json();console.log("邮件发送成功:",s),V.success(`邮件发送成功: ${t.username}`)}t.hasSent=!0,t.autoSent=!1,t.autoSentError=!1}catch(e){console.error("发送失败:",e),V.error(`发送失败: ${e.message}`),t.autoSentError=!0}finally{this.isSending=!1,t.isSending=!1}},async sendAllEmails(){try{this.isSendingAll=!0,this.workflowResults.forEach(i=>{i.isSending=!0});const t=this.workflowResults.filter(i=>i.username.includes("企微小助手")).map(i=>this.sendRobotMessage(i)),e=await this.getAccessToken();if(!e&&this.workflowResults.some(i=>!i.username.includes("企微小助手")))throw new Error("无法获取访问令牌");const o=this.workflowResults.filter(i=>!i.username.includes("企微小助手")).map(i=>fetch("https://api.nickwald.top/isyourday/",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({type:"email",pk:i.user_id,content:i.text,subject:i.title})}).then(s=>s.json()));await Promise.all([...t,...o]),this.workflowResults.forEach(i=>{i.hasSent=!0,i.autoSent=!1,i.autoSentError=!1}),V.success(`成功发送 ${this.workflowResults.length} 条消息`)}catch(t){console.error("批量发送错误:",t),V.error(`发送失败: ${t.message}`)}finally{this.isSendingAll=!1,this.workflowResults.forEach(t=>{t.isSending=!1})}},async autoSendRow(t){try{if(t.hasSent)return;if(t.isSending=!0,t.autoSent=!0,t.autoSentError=!1,t.username.includes("企微小助手"))await this.sendRobotMessage(t);else{const e=await this.getAccessToken();if(!e)throw new Error("无法获取访问令牌，请检查用户名和密码");const o=new URLSearchParams;o.append("type","email"),o.append("pk",t.user_id),o.append("content",t.text),o.append("subject",t.title);const i=await fetch("https://api.nickwald.top/isyourday/",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!i.ok){const s=await i.text();throw new Error(`请求失败 (${i.status}): ${s}`)}await i.json()}t.hasSent=!0,t.autoSent=!0,t.autoSentError=!1}catch(e){console.error("自动发送失败:",e),t.autoSentError=!0}finally{t.isSending=!1}},async autoSendAllPending(){const t=this.workflowResults.filter(e=>!e.hasSent);if(t.length!==0)try{await Promise.all(t.map(e=>this.autoSendRow(e))),V.success(`已自动发送 ${t.length} 条记录`)}catch(e){console.error("部分自动发送失败:",e)}},async executeWorkflow(){if(!this.isFormValid){this.errorMessage="请填写所有必填项并选择发送类型和发送模式";return}this.isLoading=!0,this.workflowResults=[],this.errorMessage=null;const t={username:this.username.trim(),key:this.key.trim(),mode:this.mode,select_mode:this.selectMode};this.selectMode===1&&(t.receive_username=this.receiveUsername.map(e=>`*${e}*`).join("，"));try{const e=await fetch(this.workflowUrl,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:t,response_mode:"streaming",user:"external-system"})});if(!e.ok)throw e.status===404?new Error("请求地址不存在"):e.status===401?new Error("认证失败"):new Error(`请求失败 (${e.status})`);const o=e.body.getReader(),i=new TextDecoder;let s="";for(;;){const{done:p,value:d}=await o.read();if(p)break;s+=i.decode(d,{stream:!0});const C=s.split(`
`);s=C.pop()||"",C.forEach(g=>{const T=g.trim();if(!(!T||T==="[DONE]")&&T.startsWith("data: "))try{const b=JSON.parse(T.slice(6));if(b?.data?.outputs?.send_information){const v=b.data.outputs.send_information;if(v.email&&v.username&&v.text&&v.user_id&&v.title){const x={...v,isSending:!1,hasSent:!1,autoSent:!1,autoSentError:!1};this.workflowResults.push(x),this.manualSendMode||this.autoSendRow(x)}}}catch(b){console.error("解析失败:",b)}})}}catch(e){this.errorMessage=e.message}finally{this.isLoading=!1}}}},Be={class:"page-container min-h-screen bg-gray-50 py-10 px-4 sm:px-6 lg:px-8"},ze={class:"max-w-6xl mx-auto"},Oe={class:"bg-white rounded-lg border border-gray-200"},je={class:"flex items-center p-4 bg-gray-50 border-b"},Fe={class:"ml-4 flex items-center"},He={class:"font-medium text-gray-700"},Ke={class:"font-medium text-gray-700"},We={class:"p-2"},Je={class:"text-gray-600 text-sm mb-2 line-clamp-2"},qe={class:"flex items-center space-x-2"},Qe={class:"flex flex-wrap items-center justify-center gap-4 my-6"},Ge={key:0,class:"mt-4 p-6 text-center bg-white rounded-lg border border-gray-200"},Xe={key:1,class:"mt-4 p-6 text-center bg-white rounded-lg border border-gray-200"},Ye={key:2,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm"},Ze={class:"space-y-4"},$e={key:0,class:"border border-gray-200 rounded-md p-3 mt-2"},et={class:"p-3 bg-gray-50 rounded border border-gray-200 max-h-40 overflow-y-auto",ref:"previewContainer"},tt={class:"flex justify-end space-x-3"};function st(t,e,o,i,s,p){const d=te,C=ne,g=X,T=Z,b=Y,v=ie,x=$,M=ee,N=G;return u(),y("div",Be,[m("div",ze,[e[13]||(e[13]=m("div",{class:"text-center mb-6"},[m("h1",{class:"main-title"},"工作流管理及记录")],-1)),m("div",Oe,[m("div",je,[r(d,{type:"text",class:"px-0 font-medium text-gray-700 hover:text-primary",disabled:""},{default:c(()=>e[10]||(e[10]=[E(" 发送邮件： ")])),_:1,__:[10]}),r(d,{onClick:p.sendAllEmails,disabled:s.isSendingAll||s.workflowResults.length===0,type:"primary",size:"small",class:"ml-2"},{default:c(()=>[E(S(s.isSendingAll?"发送中...":"全部发送"),1)]),_:1},8,["onClick","disabled"]),m("div",Fe,[r(C,{modelValue:s.manualSendMode,"onUpdate:modelValue":e[0]||(e[0]=a=>s.manualSendMode=a),"active-text":"手动发送","inactive-text":"自动发送",class:"mr-2"},null,8,["modelValue"])])]),r(b,{data:s.workflowResults,border:"",stripe:"",style:{width:"100%"}},{default:c(()=>[r(g,{label:"序号",width:"80",align:"center"},{default:c(a=>[m("span",He,S(a.$index+1),1)]),_:1}),r(g,{prop:"user_id",label:"用户ID",width:"120",align:"center"}),r(g,{prop:"username",label:"用户名",width:"150"}),r(g,{prop:"email",label:"邮箱",width:"200"}),r(g,{prop:"title",label:"邮件主题",width:"200"},{default:c(a=>[m("span",Ke,S(a.row.title),1)]),_:1}),r(g,{prop:"text",label:"消息内容","min-width":"500"},{default:c(a=>[m("div",We,[m("div",Je,S(p.stripHtmlTags(a.row.text).length>150?p.stripHtmlTags(a.row.text).slice(0,150)+"...":p.stripHtmlTags(a.row.text)),1),m("div",qe,[r(d,{type:"text",size:"small",onClick:P=>p.openHtmlInNewWindow(a.row.text),class:"text-primary"},{default:c(()=>e[11]||(e[11]=[E(" 查看完整HTML内容 ")])),_:2,__:[11]},1032,["onClick"]),(u(),w(d,{type:"text",size:"small",onClick:P=>p.sendSingleEmail(a.row),class:"text-green-600",disabled:s.isSending||a.row.isSending,key:`btn-${a.row.user_id}-${a.row.isSending}-${a.row.hasSent}-${a.row.autoSent}`},{default:c(()=>[E(S(a.row.isSending?"发送中...":a.row.hasSent?a.row.username.includes("企微小助手")?"重新发送机器人消息":"重新发送邮件":a.row.username.includes("企微小助手")?"发送机器人消息":"发送邮件"),1)]),_:2},1032,["onClick","disabled"])),r(d,{type:"text",size:"small",onClick:P=>p.openEditDialog(a.row,a.$index),class:"text-red-400 hover:text-red-600"},{default:c(()=>e[12]||(e[12]=[E(" 修改 ")])),_:2,__:[12]},1032,["onClick"])])])]),_:1}),r(g,{label:"自动发送状态",width:"120",align:"center"},{default:c(a=>[r(T,{type:a.row.autoSent?"success":a.row.autoSentError?"danger":"info",size:"small"},{default:c(()=>[E(S(a.row.autoSent?"成功":a.row.autoSentError?"失败":a.row.isSending?"发送中":"未发送"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])]),m("div",Qe,[r(v,{modelValue:s.username,"onUpdate:modelValue":e[1]||(e[1]=a=>s.username=a),placeholder:"请输入用户名",style:{width:"200px"}},null,8,["modelValue"]),r(v,{modelValue:s.key,"onUpdate:modelValue":e[2]||(e[2]=a=>s.key=a),placeholder:"请输入key",style:{width:"200px"}},null,8,["modelValue"]),r(M,{modelValue:s.mode,"onUpdate:modelValue":e[3]||(e[3]=a=>s.mode=a),placeholder:"请选择发送类型",style:{width:"200px"},clearable:""},{default:c(()=>[r(x,{label:"祝贺邮件",value:0}),r(x,{label:"事件处理",value:1})]),_:1},8,["modelValue"]),r(M,{modelValue:s.selectMode,"onUpdate:modelValue":e[4]||(e[4]=a=>s.selectMode=a),placeholder:"请选择发送模式",style:{width:"200px"},clearable:""},{default:c(()=>[r(x,{label:"遍历发送",value:0}),r(x,{label:"指定用户发送",value:1})]),_:1},8,["modelValue"]),s.selectMode===1?(u(),w(M,{key:0,modelValue:s.receiveUsername,"onUpdate:modelValue":e[5]||(e[5]=a=>s.receiveUsername=a),multiple:"",filterable:"",placeholder:"请选择接收用户",style:{width:"200px"}},{default:c(()=>[(u(!0),y(Ee,null,Ve(o.receiveUserOptions,a=>(u(),w(x,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):f("",!0),r(d,{onClick:p.executeWorkflow,disabled:s.isLoading||!p.isFormValid,type:"primary",style:{padding:"0 30px",height:"40px"}},{default:c(()=>[E(S(s.isLoading?"执行中...":"发起工作流请求"),1)]),_:1},8,["onClick","disabled"])]),s.workflowResults.length===0&&!s.isLoading?(u(),y("div",Ge," 暂无数据，请输入参数并点击上方按钮发起请求 ")):f("",!0),s.isLoading&&s.workflowResults.length===0?(u(),y("div",Xe," 正在加载数据... ")):f("",!0),s.errorMessage?(u(),y("div",Ye," 错误："+S(s.errorMessage),1)):f("",!0)]),r(N,{modelValue:s.editDialogVisible,"onUpdate:modelValue":e[9]||(e[9]=a=>s.editDialogVisible=a),title:"编辑邮件内容",width:"700px","close-on-click-modal":!1,"append-to-body":""},{footer:c(()=>[m("div",tt,[r(d,{onClick:e[8]||(e[8]=a=>s.editDialogVisible=!1)},{default:c(()=>e[17]||(e[17]=[E("取消")])),_:1,__:[17]}),r(d,{type:"primary",onClick:p.saveEditedRow,loading:s.isSaving},{default:c(()=>e[18]||(e[18]=[E(" 保存修改 ")])),_:1,__:[18]},8,["onClick","loading"])])]),default:c(()=>[m("div",Ze,[m("div",null,[e[14]||(e[14]=m("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"邮件主题",-1)),r(v,{modelValue:s.editingRow.title,"onUpdate:modelValue":e[6]||(e[6]=a=>s.editingRow.title=a),placeholder:"请输入邮件主题"},null,8,["modelValue"])]),m("div",null,[e[15]||(e[15]=m("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"邮件内容 (HTML格式)",-1)),r(v,{modelValue:s.editingRow.text,"onUpdate:modelValue":e[7]||(e[7]=a=>s.editingRow.text=a),type:"textarea",rows:10,placeholder:"请输入HTML格式的邮件内容",resize:"none"},null,8,["modelValue"])]),s.editingRow.text?(u(),y("div",$e,[e[16]||(e[16]=m("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"内容预览",-1)),m("div",et,null,512)])):f("",!0)])]),_:1},8,["modelValue"])])}const it=be(Ne,[["render",st],["__scopeId","data-v-9d83295d"]]),wt={__name:"Workflow",setup(t){return(e,o)=>(u(),w(it))}};export{wt as default};
